---
title:  Züchtungslehre - Berechnung der Inzucht
author: Peter von Rohr
date: 2016-11-04
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, results = 'asis')
```

```{r DocumentStatus, eval=FALSE}
r6obj_docstat <- rmddochelper::R6ClassDocuStatus$new()
r6obj_docstat$set_current_status(psVersion = "0.0.901",
                                 psStatus  = "Initialisation",
                                 psProject = "ZL_HS_2016")
r6obj_docstat$include_doc_stat(psTitle = "## Document Status")
```


```{r TableAbbreviation}
r6ob_abbrtable <- rmddochelper::R6ClassTableAbbrev$new()
### # include table of abbreviations only, if there are any
if (!r6ob_abbrtable$is_empty_abbr())
  r6ob_abbrtable$include_abbr_table(psAbbrTitle = "## Abbreviations")
```

## Einleitung
Im Kapitel __Inverse Verwandtschaftsmatrix__ haben wir besprochen, wie die inverse Verwandtschaftsmatrix direkt aufgestellt werden kann. Die verwendete Methode basiert auf der LDL-Zerlegung der Matrix $A$, wobei die Inversen der Matrizen $L$ und $D$ einfacher zu berechnen sind als jene von $A$. 

Die Inverse $D^{-1}$ ist eine Diagonalmatrix, deren Elemente von den Inzuchtkoeffizienten der Tiere abhängen. Die Inzuchtkoeffizienten erscheinen auf der Diagonalen der Verwandtschaftsmatrix. Also müssten wir für die Berechnung der Inzuchtkoeffizienten die komplette Verwandtschaftsmatrix aufstellen. Für sehr grosse Populationen ist das zu aufwändig. Wir brauchen also eine effizientere Methode zur Berechnung der Inzuchtkoeffizienten.


## Berechnung der Inzuchtkoeffizienten
Grundsätzlich gibt es zwei Arten die Inzuchtkoeffizienten zu berechnen, ohne die gesamte Verwandtschaftsmatrix aufzustellen.

1. Cholesky-Zerlegung der Verwandtschaftsmatrix
2. Pfadkoeffizientenmethode


## Cholesky-Zerlegung der Verwandtschaftsmatrix
Die Bezeichnung dieser Methode ist etwas irreführend, da wir ja die Verwandtschaftsmatrix explizit nicht kennen und deshalb auch nicht zerlegen können. Viel mehr wollen wir günstige Eigenschaften der Cholesky-Zerlegung der Verwandtschaftsmatrix ausnützen um die Inzuchtkoeffizienten effizient berechnen zu können. Zur Ableitung der Eigenschaften der Cholesky-Zerlegung, nehmen wir vorübergehend an, dass wir die Verwandtschaftsmatrix $A$ kennen. 

Bei bekannter Verwandtschaftsmatrix $A$ ist deren Cholesky-Zerlegung definiert als 

\begin{equation}
A = R * R^T
\label{eq:CholMatA}
\end{equation}

wobei $R$ eine linke untere Dreiecksmatrix ist. Aufgrund der Dreiecksstruktur von $R$ lassen sich die Diagonalelemente von $A$ berechnen als Summen der quadrierten Elemente von $R$ bis zur Diagonalen. Als Formel bedeutet das 

\begin{equation}
a_{ii} = \sum_{j=1}^i r_{ij}^2
\label{eq:DiagElemMatA}
\end{equation}
```{r WriteTableOfAbbreviations, results='hide'}
r6ob_abbrtable$writeToTsvFile()
```
<!-- END of document                 -- 
  -- Below this must not be anything --> 
