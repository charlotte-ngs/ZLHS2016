---
title:  Züchtungslehre - Tierzucht und Selektionsindex
author: Peter von Rohr
date: 2016-10-07
output: 
  pdf_document:
    fig_caption: FALSE
    includes:
      in_header: header.tex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, results = 'asis')
```

```{r DocumentStatus, eval=FALSE}
r6obj_docstat <- rmddochelper::R6ClassDocuStatus$new()
r6obj_docstat$set_current_status(psVersion = "0.0.901",
                                 psStatus  = "Initialisation",
                                 psProject = "[REPLACE_WITH_PROJECT]")
r6obj_docstat$include_doc_stat(psTitle = "## Document Status")
```


```{r TableAbbreviation}
r6ob_abbrtable <- rmddochelper::R6ClassTableAbbrev$new()
### # include table of abbreviations only, if there are any
if (!r6ob_abbrtable$is_empty_abbr())
  r6ob_abbrtable$include_abbr_table(psAbbrTitle = "## Abbreviations")
```

## Tierzucht
In der Tierzucht gibt es zwei __fundamentale Fragen__, welche alle Züchterinnen und Züchter beschäftigt. 

1. Welches Tier ist das beste?
2. Wie sollen Tiere ausgewählt werden, dass ihre Nachkommen besser sind als die aktuelle Population

### Das beste Tier
Da wir im allgemeinen nicht nur an einer Eigenschaft bei den Nutztieren interessiert sind, stellt sich die Frage nach der optimalen Kombination an Eigenschaften. Ist zum Beispiel die Milchkuh die beste, welche eine möglichst hohe Milchleistung hat oder spielen Eutergesundheit, ein gutes Fundament oder Krankheitsresistenz auch eine Rolle? Müssen Schweine möglichst schnell wachsen oder sind ein gutes Geburtsverhalten und überdurchschnittliche Fleischqualität auch wichtig?

Die Bezeichnung "das beste Tier" ist ein relativer Begriff. Absolut gesehen gibt es kein bestes Tier. Die Klassierung von Tieren ist immer relativ zu einer Umwelt, in welcher sich die Tiere befinden. Eine Hochleistungsmilchkuh hätte sehr viel Mühe in einem Wüstengebiet in Afrika zu überleben. Bei den kommenden Ausführungen gehen wir davon aus, dass die Umwelt für die Tiere optimal ist.

Die Beschreibung von Tieren basiert entweder auf deren äusserem Erscheinungsbild oder aufgrund von Leistungen oder einer Kombination von beidem. In jedem Fall sprechen wir von __Merkmalen__. Ein Merkmal ist definiert als beobachtbare oder messbare Eigenschaft eines Tieres. 

Als Beispiele für beobachtete Merkmale sind 

* Fellfarbe
* Grösse
* Bemuskelung
* Fundament
* Euter

Beispiele für messbare Merkmale sind

* Körpergewicht
* Milchproduktion
* Wachstum
* Futteraufnahme

Wichtig ist, dass es bei den Merkmalen nicht um die Beschreibung eines einzelnen Tieres geht. Ein Tier kann rote Fellfarbe und ein Körpergewicht von $343 kg$ aufweisen. Aber `rot` und $343 kg$ sind nicht die Merkmale, sondern die Merkmalsausprägungen oder der __Phänotyp__. Die Merkmale sind nur __Körpergewicht__ und __Fellfarbe__. 

In der Tierzucht beschäftigen wir uns vor allem mit der genetischen Veränderung von Populationen. Das genetische Potential wird von einem Tier an die nächste Generation weitergegeben. Das genetische Potential eines Tieres wird durch den __Genotypen__ repräsentiert. Den Zusammenhang zwischen phänotypischem Merkmal und Genotyp eines Individuums wird durch das folgende uns schon bekannte Modell hergestellt.

$$ y = \mu + g + \epsilon$$

wobei $y$ der phänotypische Wert eines Merkmals ist, $\mu$ dem Populationsmittel entspricht, $g$ für den genotypischen Wert steht und $\epsilon$ der umweltbedingte Rest darstellt.

Schon im Kapitel "Quantitative Genetik" hatten wir gesehen, dass aufgrund der Vererbung, nicht der Genotyp eines Tieres an die nächste Generation weitergegeben wird sondern nur eine zufällige Auswahl der Allele. Somit ist nicht der genotypische Wert sondern der genetisch additive Anteil des genotypischen Wertes von zentraler Bedeutung. Den genetsch additiven Anteil hatten wir als __Zuchtwert__ bezeichnet und wir sehen hier, dass der Zuchtwert eines Tieres in der Beurteilung der Tiere hinsichtlich ihrer Eignung als Elterntiere eine zentrale Rolle spielt. Formell hatten wir im Kapitel "Quantitative Genetik" den genotypischen Wert $g$ in Zuchtwert $a$, Dominanzabweichung $d$ und Epistasie $i$ aufgeteilt. Somit setzt sich der phänotypische Wert eines Merkmals wie folgt zusammen.

$$ y = \mu + a + d + i + \epsilon$$

Bei der Dominanzabweichung $d$ und der Epistasie $i$ handelt es sich um Interaktionen an einem Lokus oder zwischen Loci. Diese sind somit abhängig vom Paarungsparter und nur schwer zu quantifizieren. Deshalb werden diese beiden Effekte auch häufig zusammen mit den Umweltfaktoren $e$ in einen neuen Restterm $e$ zusammengefasst.

\begin{IEEEeqnarray}{rCl}
y &=& \mu + a + e
\label{eq:PhenAddGen}
\end{IEEEeqnarray}


### Auswahl der Elterntiere
Bei der Auswahl der Elterntiere stehen uns zwei Werkzeuge zur Verfügung. 

1. Selektion
2. Gezielte Anpaarung


### Selektion
Selektion wird verwendet um langfristige genetische Änderungen in einer Population zu bewirken. Der Unterschied zwischen gerichteter Selektion und Vermehrung sind in den nachfolgenden beiden Diagrammen gezeigt. 

```{r ZuechtungElternNachkommen}
rmddochelper::insertOdgAsPdf(psOdgFileStem = "ZuechtungElternNachkommen", pnPaperWidthScale = 0.6)
```

Im Gegensatz zur gerichteten Selektion steht die reine Vermehrung, welche im folgenden Schema gezeigt ist. Bei der Vermehrung wird keine Verbesserung der Nachkommen im Vergleich zu den Elterntieren angestrebt.

```{r VermehrungElternNachkommen}
rmddochelper::insertOdgAsPdf(psOdgFileStem = "VermehrungElternNachkommen", pnPaperWidthScale = 0.6)
```


Als Selektion versteht man den Prozess, welcher bestimmt welche Tiere aus einer Population Eltern werden, wie viele Nachkommen sie produzieren sollen und wie lange sie in der Zuchtpopulation verbleiben. Wir sind vertraut mit der __natürlichen Selektion__, welche auch oft mit dem Schlagwort "survival of the fittest" zusammengefasst wird. Damit ist gemeint, dass Tiere, welche optimal an eine Umwelt angepasst sind haben eine höhere Wahrscheinlichkeit zu überlegen und sich somit fortzupflanzen. 

In der Tierzucht ist aber vor allem die __künstliche Selektion__ von Interesse. Die Idee hinter der künstlichen Selektion ist, die Individuen mit dem besten Set von Genen auszuwählen und diese sich vermehren zu lassen. Die Tiere mit dem besten Set von Genen haben den besten Wert als Zuchttiere. Dieser Wert wird anhand unseres vorher definierten Begriffs des __Zuchtwertes__ gemessen.

Die einfachste Form der Selektion ist die phänotypische Selektion. Dabei werden die Tiere alleine aufgrund der phänotypischen Leistung selektiert. Diese Art der Selektion wird kaum mehr verwendet, ist aber sehr einfach und illustrativ für Erklärungen. Aktuell sollten Tiere aufgrund ihrer __Zuchtwerte__ selektiert werden. Unter der Annahme, dass Zuchtwerte normal verteilt sind, sind die Vorgänge von der phänotypischen Selektion auf die Selektion nach Zuchtwerten übertragbar.

Das nachfolgende Bild zeigt die Verteilung eines phänotypischen Merkmals in einer Population. Dabei stehen ED für Elterndurchschnitt, SG für Selektionsgrenze und RD für Remontendurchschnitt.

```{r GerichteteSelektionElternNk}
rmddochelper::insertOdgAsPdf(psOdgFileStem = "GerichteteSelektionElternNk")
```

### Gezielte Paarung
Die gezielte Paarung ist der Prozess, in welchem bestimmt wird, welche Tiere miteinander gepaart werden sollen. Dies ist verschieden von der Selektion. In der Selektion werden nur die zukünftigen Eltern aus der Population ausgewählt. Bei der gezielten Paarung geschieht die Zuordnung der Paarungspartner. Die Zuordnung der Paarungspartner kann auf sehr verschiedene Arten passieren. Die Art der Zuordnung bestimmt dann das Paarungssystem. Dabei können verschiedene Ziele verfolgt werden, wie zum Beispiel

a) Maximierung des Zuchtwertes
b) Ausnützung gegensätzlicher Eigenschaften
c) Erzielung von Heterosis-Effekten

Paarungen können innerhalt der gleichen Rasse geplant werden, dann spricht man von __Reinzucht__. Werden Partner aus verschiedenen Rassen gepaart, bezeichnen wir das als __Kreuzungszucht__. 

Der Mittelwert der Zuchtwerte der Elterntiere liefert uns eine erste Information über den zu erwartenden Zuchtwert des Nachkommens. Dieser wird als __Abstammungszuchtwert__ bezeichnet. Dieser erste geschätzte Zuchtwert liegt schon vor bevor der Nachkomme geboren wurde. Abstammungszuchtwerte sind aber nicht die einzige Art von Zuchtwerten, welche in der Tierzucht verwendet werden. In den nachfolgenden Abschnitten werden wir uns noch etwas genauer damit beschäftigen, welche verschiedenen Arten von Zuchtwerten es gibt und wie diese geschätzt werden.


## Zuchtwertschätzung unter Verwendung verschiedener Informationsquellen
In jedem Zuchtprogramm ist die Schätzung von Zuchtwerten eine zentraler Bestandteil. Die Genauigkeit der geschätzten Zuchtwerte hängt sehr stark von den verfügbaren Daten ab. Bei den Daten handelt es sich meist um phänotypische Beobachtungswerte und um Verwandtschaftsbeziehungen. Die verfügbaren SNP-Informationen für die genomische Selektion wird hier noch nicht betrachtet. 

Zu Beginn der züchterischen Arbeit sind meist nur phänotypische Informationen von einzelnen Tieren verfügbar. In späteren Stadien kommen Messungen von verwandten Tieren und von Nachkommen hinzu. Zuchtwerte müssen also zuerst auf der Basis von phänotypischen Informationen des Tieres alleine geschätzt werden. Nach und nach können für die Zuchtwertschätzung auch Informationsquellen von verwandten Tieren berücksichtigt werden. 

Meist werden in Zuchtprogrammen nicht nur einzelne Merkmale bearbeitet. Häufig sind ganze Gruppen von Merkmalen von Interesse. Verschiedene Merkmale können gleichzeitig über die Definition eines sogenannten __Selektionsindexes__ berücksichtigt werden.

### Das Modell
Eine phänotypische Beobachtung $y_{ij}$ eines Tieres $i$ in einem Merkmal $j$ ist beeinflusst durch allgemeine identifizierbare Umweltfaktoren $\mu_i$, durch die additiv genetischen Effekte $a_i$ und durch einen Restterm $e_{ij}$. 

\begin{IEEEeqnarray}{rCl}
y_{ij} &=& \mu_i + a_i + e_{ij}
\label{eq:BasicModel}
\end{IEEEeqnarray}

Die Aufteilung des totalen genotypischen Wertes $g_i$ in additiven Effekt $a_i$, Dominanzabweichung $d_i$ und Epistasis $i_i$ und die Verschiebung der Dominanzabweichung und der Epistasie in den Restterm wurde schon bei der Herleitung des Modells (\ref{eq:PhenAddGen}) besprochen und deshalb hier nicht weiter ausgeführt.

Das Modell in (\ref{eq:BasicModel}) ist ein lineares Modell, welches in der Tierzucht sehr weit verbreitet ist. Meist wird angenommen, dass der Vektor $y$ aller Beobachtungen in  einer Population einer multivariaten Normalverteilung folgt. Diese Annahme wird durch den zentralen Grenzwertsatz begründet, welcher besagt, dass eine Zufallsvariable, welche aus einer Summe mit sehr vielen Summanden mit sehr kleinem Effekt zusammengesetzt ist, sich einer Normalverteilung nähert. Das Argument des zentralen Grenzwertsatzes wird zuerst einmal auf den additiv genetischen Effekt $a$ angewendet. Auch für den Resteffekt $e$ wird angenommen, dass sich diese zufälligen Resteffekte aus sehr vielen kleinen Effekten zusammensetzen. Somit folgen $a$ und $e$ einer Normalverteilung. Die systematischen mittleren Umwelteffekte $\mu$ werden als fix angenommen und zeigen somit nicht den Charakter einer Zufallsvariablen mit einer Verteilung. Da $a$ und $e$ normal verteilt sind und $\mu$ als fixer Effekt angenommen wird, folgt auch $y$ einer Normalverteilung. Dieses hier beschriebene Modell trägt den Namen __infinitesimal model__.

Zu den Annahmen der Verteilungen der Zufallsvariablen im Modell (\ref{eq:BasicModel}) gehören auch die __Erwartungswerte__ und die __Varianzen__. Da die Effekte $a$ und $e$ als Abweichungen von einem Mittel definiert sind, ist deren Erwartungswert $E(a) = E(e) = 0$. Somit gilt für den Erwartungswert $E(y)$ von $y$: $E(y) = \mu$. Die Varianzen von $a$ und $e$ werden als bekannt angenommen. Zwischen $a$ und $e$ sollen keine Covarianzen auftreten, d.h. $cov(a,e) = 0$. Auch zwischen den Resteffekten verschiedener Tiere $i$ ud $k$ sollen keine Covarianzen bestehen, d.h. $cov(e_i, e_k) = 0$. Aus diesen Annahmen lässt sich für die Varianz von $y$ ableiten, dass

$$var(y) = var(a) + var(e)$$


## Schätzung des Zuchtwertes aufgrund von Eigenleistungen
### Eine einzelne Eigenleistung
Falls nur eine Leistung pro Tier zur Verfügung steht, dann lassen sich die Zuchtwerte aus der Regression der phänotypischen Leistungen auf die additiv genetischen Werte schätzen. Da die additiv genetischen Werte unbekannt sind, ist auch die Regression unbekannt. Aber es ist trotzdem hilfreich sich vorzustellen, wie diese Regression aussehen würde. 

```{r RegPhenAddGen}
rmddochelper::insertOdgAsPdf(psOdgFileStem = "RegPhenAddGen")
```

Die rote Gerade im obigen Diagramm zeigt die Regressionsgerade der additiv genetischen Werte auf die phänotypischen Beobachtungen. Da wir den additiv genetischen Wert $a_i$ nicht kennen schätzen wir ihn und bezeichnen den Schätzwert als $\hat{a}_i$. Den Schätzwert berechnen wir als

\begin{IEEEeqnarray}{rCl}
\hat{a}_i &=& b(y_i - \mu)
\label{eq:HatA}
\end{IEEEeqnarray}

wobei $b$ der Regressionskoeffizient der additiv genetischen Werte auf die phänotypischen Beobachtungen darstellt. Den Regressionskoeffizienten $b$ berechnen wir aus den Covarianzen der Zufallsvariablen als

\begin{IEEEeqnarray}{rCl}
b & = & \frac{cov(a,y)}{var(y)}
\label{eq:RegCoefB}
\end{IEEEeqnarray}

wobei $$cov(a,y) = cov(a,\mu + a + e) = cov(a,\mu) + cov(a,a) + cov(a,e)$$ Aus den Annahmen zum Modell (\ref{eq:BasicModel}) wissen wir, dass $cov(a,\mu) = cov(a,e) = 0$. Die Covarianz der Zufallsvariablen mit sich selber entspricht der Varianz der Zufallsvariablen und somit ist $cov(a,a) = var(a)$. Somit haben wir als Resultat für den Regressionskoeffizienten 

\begin{equation}
b = \frac{cov(a,y)}{var(y)}  =  \frac{var(a)}{var(y)} = h^2
\label{eq:RegCoefBResult}
\end{equation}

Der Term $h^2$ steht für die Heritabilität. Somit entspricht der geschätzte Zuchtwert aufgrund einer Eigenleistung das Produkt aus Heritabilität mal die um den Mittelwert $\mu$ korrigierten Phänotypen $y$

\begin{equation}
\hat{a}_i  =  b(y_i - \mu) = h^2(y_i - \mu)
\label{eq:HatAResult}
\end{equation}

Die Korrelation zwischen dem wahren Zuchtwert und dem Selektionskriterium, hier die phänotypische Beobachtung, entspricht der Genauigkeit des geschätzten Zuchtwertes. Diese Korrelation bietet eine Möglichkeit die verschiedenen Selektionskriterien auf ihre Genauigkeit hin zu vergleichen. Je höher die Korrelation, desto besser die Genauigkeit und desto geeigneter das Selektionskriterium. Die Schätzgenauigkeit wird sehr oft auch als Bestimmtheitsmass ($r^2$) ausgewiesen. Für unser Beispiel einer einzelnen Eigenleistung ist die Genauigkeit

\begin{IEEEeqnarray}{rCl}
r_{a,y} & = & \frac{cov(a,y)}{\sigma_a \sigma_y} \nonumber\\
        & = & \frac{\sigma_a^2}{\sigma_a \sigma_y} = h
\end{IEEEeqnarray}

und das Bestimmtheitsmass $r^2 = h^2$.

Der __erwartete Selektionserfolg__ ($R$) auf der Basis einer einzelnen Eigenleistung beträgt

\begin{equation}
R = i r_{a,y}^2 \sigma_y = i h^2 \sigma_y
\end{equation}

wobei $i$ der Selektionsintensität also der Überlegenheit der selektierten Individuen ausgedrückt in Einheiten der phänotypischen Standardabweichung.

Die Varianz der geschätzten Zuchtwerte ist

\begin{equation}
var(\hat{a}) = var(by) = var(h^2y) = h^4 \sigma_y^2 = r_{a,y}^2 h^2 \sigma_y^2 = r_{a,y}^2 \sigma_a^2
\end{equation}

### Wiederholte Messungen
Falls bei einem Tiere mehrere wiederholte Messungen des gleichen Merkmals vorliegen, kann der Zuchtwert aus dem Mittelwert der wiederholten Messungen geschätzt werden. Mit den wiederholten Messungen wird angenommen, dass sich die Messungen eines Tieres aufgrund der Umweltfaktoren ähnlicher sind. Es gibt also eine zusätzliche Covarianz bei Messungen eines Tieres. Die Varianz ($var(y)$) der phänotypischen Beobachtung kann somit aufgeteilt werden in 

$$var(y) = var(a) + var(pe) + var(te)$$

wobei $var(pe)$ die Varianz aufgrund der permanenten Umwelt darstellt und $var(te)$ der zufälligen Umweltvarianz entspricht.

### Zuchtwertschätzung aufgrund von Nachkommen

### Zuchtwertschätzung aufgrund von Pedigreeinformation

### Andere Merkmale

### Selektionsindex


```{r WriteTableOfAbbreviations, results='hide'}
r6ob_abbrtable$writeToTsvFile()
```
<!-- END of document                 -- 
  -- Below this must not be anything -->


